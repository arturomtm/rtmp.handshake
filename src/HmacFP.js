import crypto from 'crypto';

const FP_PRIVATE_KEY = new Buffer([
  0x47, 0x65, 0x6E, 0x75, 0x69, 0x6E, 0x65, 0x20,
  0x41, 0x64, 0x6F, 0x62, 0x65, 0x20, 0x46, 0x6C,
  0x61, 0x73, 0x68, 0x20, 0x50, 0x6C, 0x61, 0x79,
  0x65, 0x72, 0x20, 0x30, 0x30, 0x31, // Genuine Adobe Flash Player 001
  0xF0, 0xEE, 0xC2, 0x4A, 0x80, 0x68, 0xBE, 0xE8,
  0x2E, 0x00, 0xD0, 0xD1, 0x02, 0x9E, 0x7E, 0x57,
  0x6E, 0xEC, 0x5D, 0x2D, 0x29, 0x80, 0x6F, 0xAB,
  0x93, 0xB8, 0xE6, 0x36, 0xCF, 0xEB, 0x31, 0xAE
]);

export default (input) => {
  const genuineFP = FP_PRIVATE_KEY.slice(0, 30)
  const hmac =  crypto.createHmac('sha256', genuineFP);
  hmac.update(input);

  return hmac.digest();
};
